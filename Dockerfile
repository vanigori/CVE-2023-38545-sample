FROM debian:latest

RUN apt update && apt install -y --fix-missing \
    git \
    build-essential \
    wget \
    python3 \
	netcat-openbsd \
    libssl-dev

WORKDIR /exploit

COPY malicious_redirect_server.sh malicious_redirect_server.sh

RUN chmod 777 malicious_redirect_server.sh

COPY tgsocksproxy.py proxy.py

RUN chmod 777 malicious_redirect_server.sh

WORKDIR /build

RUN wget https://github.com/curl/curl/releases/download/curl-7_81_0/curl-7.81.0.tar.gz

RUN tar -xzvf curl-7.81.0.tar.gz

WORKDIR /build/curl-7.81.0

RUN ./configure --with-openssl

RUN make -j$(nproc)

RUN make install

RUN cp -r /usr/local/lib /usr/lib

RUN ldconfig

WORKDIR /

ENTRYPOINT [ "/bin/bash"]